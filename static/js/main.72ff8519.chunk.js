(this.webpackJsonptaxodium=this.webpackJsonptaxodium||[]).push([[0],{146:function(e,t){},203:function(e,t,n){},204:function(e,t,n){},205:function(e,t,n){},207:function(e,t){},253:function(e,t,n){"use strict";n.r(t);var a=n(7),o=n.n(a),i=n(178),r=n.n(i),c=(n(203),n(53)),s=n(46),l=(n(204),n(115)),d=n(27),u=n(266),b=n(268),m=n(273),j=n(274),h=n(269),g=n(275),f=(n(205),n(6));var x=function(e){var t=e.isShown,n=e.progress;return t?Object(f.jsxs)("div",{className:"w-full h-full fixed bg-white text-center",children:[" ",Object(f.jsx)("div",{className:"loader z-50",children:"Loading..."}),Object(f.jsxs)("div",{className:"text-black",children:["Loading ",n,"%"]})]}):Object(f.jsx)(f.Fragment,{})},p=n(84);function O(e,t,n,a){var o=Object(d.a)(Object(d.a)({},e),{},{data:v(e.data,t,n,a),visible:!0,id:e.id+"_coarse"}),i=function(e){return Object(d.a)(Object(d.a)({},e),{},{id:e.id.replace("main","mini"),lineWidthScale:1,pickable:!1,getRadius:e.id.includes("search")?.5*e.getRadius:e.getRadius})}(o);return[o,Object(d.a)(Object(d.a)({},e),{},{visible:!0,id:e.id+"_fine"}),i]}function v(e,t,n,a){var o={};return e.filter((function(e){if(a&&Math.abs(t.x[e]-t.x[t.parents[e]])>1|Math.abs(t.y[e]-t.y[t.parents[e]])>.5)return!0;var i=Math.round(t.x[e]*n)/n,r=Math.round(t.y[e]*n)/n;return o[i]?!o[i][r]&&(o[i][r]=1,!0):(o[i]=Object(l.a)({},r,1),!0)}))}var y=[{contour:[[-100,-100],[-100,100],[100,100],[100,-100]],zipcode:94107,population:26599,area:6.11}];function w(e){if(void 0===e)return[200,200,200];if("unknown"===e)return[200,200,200];if("USA"===e)return[95,158,245];if("England"===e)return[214,58,15];if("Scotland"===e)return[255,130,82];if("Wales"===e)return[148,49,22];if("Northern Ireland"===e)return[140,42,15];if("France"===e)return[140,28,120];if("Germany"===e)return[106,140,28];if("India"===e)return[61,173,166];if("Denmark"===e)return[24,112,32];var t=0;if(0===(e=e.split("").reverse().join("")).length)return t;for(var n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t),t&=t;var a=[0,0,0];for(n=0;n<3;n++){var o=t>>8*n&255;a[n]=o}return a[0]+a[1]+a[2]<150||a[0]+a[1]+a[2]>500?w(e+"_"):a}function N(e){var t=w(e);return"rgb(".concat(t[0],",").concat(t[1],",").concat(t[2],")")}var k=function(e){return[1/Math.pow(2,e-5.6),0,0,0,0,1,0,0,0,0,1,0,0,0,0,1]},S=function(e){return 7/Math.pow(2,e.zoom-5.6)};var C=function(e){var t=e.data,n=e.colourBy,o=e.progress,i=e.setSelectedNode,r=e.scatterIds,l=e.search_configs_initial,v=e.zoomToSearch,C=Object(a.useState)({ids:[],top:0,bottom:0}),_=Object(s.a)(C,2),M=_[0],I=_[1],z=t.node_data,A=Object(a.useState)(),T=Object(s.a)(A,2),P=T[0],D=T[1],L=Object(a.useState)({zoom:4.7,target:[6,13]}),R=Object(s.a)(L,2),E=R[0],F=R[1],W=Object(a.useRef)(null),q=Object(a.useCallback)((function(e){var t=e.viewId,n=e.viewState;e.oldViewState;if("minimap"!==t&&(n.minimap={zoom:3,target:[5,13]},n.target[0]=S(n),W.current.viewports.length)){var a=W.current.viewports[0],o=a.unproject([0,0,0]),i=a.unproject([a.width,a.height,0]);i[0]=i[0]*Math.pow(2,n.zoom-6),o[0]=o[0]*Math.pow(2,n.zoom-6),n=Object(d.a)(Object(d.a)({},n),{},{nw:o,se:i,needs_update:!1}),o[0]=-500,i[0]=500,F(n)}}),[W]),G=Object(a.useState)(!1),B=Object(s.a)(G,2),U=B[0],V=B[1],H=Object(a.useCallback)((function(e){if(0===e.buttons&&"onPointerMove"===e._reactName)return!1;var t=W.current.pickObject({x:e.nativeEvent.offsetX,y:e.nativeEvent.offsetY,radius:1});if("onPointerDown"===e._reactName&&(t&&"minimap"===t.viewport.id?V(!0):V(!1)),t&&"main"===t.viewport.id&&"onClick"===e._reactName&&i(t.object),t||"onClick"!==e._reactName||i(null),t&&"minimap"===t.viewport.id&&U){var n=Object(d.a)(Object(d.a)({},E),{},{target:[S(E),t.coordinate[1]],needs_update:!0});F(n)}}),[E,U,i]),Z=Object(a.useMemo)((function(){return new b.a({id:"mini-poly-layer",data:y,pickable:!0,stroked:!0,opacity:.5,filled:!0,wireframe:!0,getPolygon:function(e){return e.contour},getFillColor:function(e){return[240,240,240]},getLineColor:[80,80,80],getLineWidth:1,lineWidthUnits:"pixels"})}),[]),J=Object(a.useMemo)((function(){return{data:r.filter((function(){return!0})),visible:!0,opacity:.6,getRadius:3,radiusUnits:"pixels",id:"main-scatter",pickable:!0,getLineColor:[100,100,100],lineWidthUnits:"pixels",lineWidthScale:1,onHover:function(e){return D(e)},getPosition:function(e){return[z.x[e],z.y[e]]},getFillColor:function(e){return"lineage"===n?w(t.lineage_mapping[z.lineages[e]]):"country"===n?w(t.country_mapping[z.countries[e]]):[200,200,200]}}}),[r,z,t,n]),X=Object(a.useMemo)((function(){return O(J,z,100)}),[J,z]),K=Object(a.useMemo)((function(){return X.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{modelMatrix:e.id.includes("mini")?void 0:k(E.zoom),stroked:e.id.includes("mini")?void 0:E.zoom>15,radiusMaxPixels:e.id.includes("mini")?2:E.zoom>15?E.zoom/5:3})}))}),[X,E.zoom]),Q=Object(a.useMemo)((function(){return K.map((function(e){return new m.a(e)}))}),[K]),Y=Object(a.useMemo)((function(){var e;return(e=[]).concat.apply(e,Object(c.a)(l.map((function(e){return O(e,z,100)}))))}),[l,z]),$=Object(a.useMemo)((function(){return Y.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{modelMatrix:e.id.includes("mini")?void 0:k(E.zoom)})}))}),[Y,E.zoom]),ee=Object(a.useMemo)((function(){return $.map((function(e){return new m.a(e)}))}),[$]),te=Object(a.useMemo)((function(){return{id:"main-line",data:z.ids,pickable:!1,getWidth:1,getTargetPosition:function(e){return[z.x[z.parents[e]],z.y[e]]},getSourcePosition:function(e){return[z.x[e],z.y[e]]},getColor:[150,150,150]}}),[z]),ne=Object(a.useMemo)((function(){return{id:"main-line-2",data:z.ids,pickable:!1,getWidth:1,getTargetPosition:function(e){return[z.x[z.parents[e]],z.y[z.parents[e]]]},getSourcePosition:function(e){return[z.x[z.parents[e]],z.y[e]]},getColor:[150,150,150]}}),[z]),ae=Object(a.useMemo)((function(){return[].concat.apply([],[te,ne].map((function(e){return O(e,z,100,!0)})))}),[te,ne,z]),oe=Object(a.useMemo)((function(){return ae.map((function(e){return Object(d.a)(Object(d.a)({},e),{},{modelMatrix:e.id.includes("mini")?void 0:k(E.zoom)})}))}),[ae,E.zoom]),ie=Object(a.useMemo)((function(){return oe.map((function(e){return new j.a(e)}))}),[oe]);if(E.zoom>17&&!0!==E.needs_update)if(E.nw[1]>M.top&E.se[1]<M.bottom);else{var re=E.nw[1],ce=E.se[1],se=ce-re,le=re-4*se,de=ce+4*se,ue=r.filter((function(e){return z.y[e]>le&z.y[e]<de}));I({top:le,bottom:de,ids:ue})}var be=Object(a.useMemo)((function(){return{id:"main-text-layer",data:M.ids,getPosition:function(e){return[z.x[e]+.3,z.y[e]]},getText:function(e){return z.genbanks[e]},getColor:[180,180,180],getAngle:0,billboard:!0,getTextAnchor:"start",getAlignmentBaseline:"center"}}),[z,M]),me=Object(a.useMemo)((function(){return[new h.a(Object(d.a)(Object(d.a)({},be),{},{visible:E.zoom>18.5,getSize:E.zoom>19?12:9.5,modelMatrix:k(E.zoom)}))]}),[be,E]),je=Object(a.useMemo)((function(){var e;return console.log(E),e=void 0!==E.nw?[{contour:[[-100,-100],[100,-100],[100,E.nw[1]],[-100,E.nw[1]]],color:[100,100,100]},{contour:[[-100,E.nw[1]],[100,E.nw[1]],[100,E.se[1]],[-100,E.se[1]]],color:[255,255,255]},{contour:[[-100,E.se[1]],[100,E.se[1]],[100,300],[-100,300]],color:[150,150,150]}]:[],new b.a({id:"mini-pos",data:e,opacity:.05,radiusMinPixels:4,radiusMaxPixels:4,getRadius:4,getLineWidth:.1,getPolygon:function(e){return e.contour},getFillColor:function(e){return e.color}})}),[E]),he=Object(a.useMemo)((function(){return[Z].concat(Object(c.a)(me),Object(c.a)(ie),Object(c.a)(Q),Object(c.a)(ee),[je])}),[Z,me,Q,ie,je,ee]);window.deck=W;var ge=Object(a.useMemo)((function(){return[new g.a({id:"main",controller:!0}),new g.a({id:"minimap",x:"79%",y:"1%",width:"20%",height:"35%",borderWidth:"1px",controller:!0})]}),[]),fe=Object(a.useMemo)((function(){if(P&&P.object){var e=t.lineage_mapping[z.lineages[P.object]],n=t.country_mapping[z.countries[P.object]],a=t.date_mapping[z.dates[P.object]];return Object(f.jsxs)("div",{className:"bg-gray-100 p-3 opacity-90 text-sm",style:{position:"absolute",zIndex:1,pointerEvents:"none",left:P.x,top:P.y},children:[Object(f.jsx)("h2",{className:"font-bold",children:z.genbanks[P.object]}),Object(f.jsx)("div",{style:{color:N(e)},children:e}),Object(f.jsxs)("div",{children:[" ",n]}),a,Object(f.jsx)("div",{className:"text-xs",children:z.mutations[P.object]&&z.mutations[P.object].mutation&&z.mutations[P.object].mutation.map((function(e){return t.mutation_mapping[e]})).join(", ")})]})}}),[t,z,P]),xe=Object(a.useMemo)((function(){return 0===z.ids.length}),[z]),pe=Object(a.useCallback)((function(e){var t=Object(d.a)(Object(d.a)({},E),{},{zoom:E.zoom+e,needs_update:!0}),n=Object(d.a)(Object(d.a)({},t),{},{target:[S(t),t.target[1]]});F(n)}),[E]);return Object(a.useEffect)((function(){if(null!==v.index){console.log(v);var e=Object(d.a)(Object(d.a)({},E),{},{zoom:19,needs_update:!0}),t=Object(d.a)(Object(d.a)({},e),{},{target:[S(e),z.y[l.filter((function(e){return e.original_index===v.index}))[0].data[0]]]});F(t)}}),[v]),Object(f.jsxs)("div",{className:"w-full h-full relative",onClick:H,onPointerMove:H,onPointerDown:H,children:[" ",Object(f.jsxs)(u.a,{onAfterRender:function(){(void 0===E.nw||E.needs_update)&&q({viewState:E})},ref:W,views:ge,viewState:E,onViewStateChange:q,layerFilter:Object(a.useCallback)((function(e){var t=e.layer,n=e.viewport;return(t.id.startsWith("main")&&"main"===n.id||t.id.startsWith("mini")&&"minimap"===n.id&&!0!==window.hidemini)&(t.id.includes("mini")|E.zoom<8&!t.id.includes("fine")|E.zoom>8&!t.id.includes("coarse"))}),[E.zoom]),controller:!0,layers:he,children:[fe,Object(f.jsxs)("div",{style:{position:"absolute",right:"0.2em",bottom:"0.2em"},children:[Object(f.jsx)("button",{className:" w-12 h-10 bg-gray-100  p-1 rounded border-gray-300 text-gray-700 opacity-60 hover:opacity-100",onClick:function(){pe(.6)},children:Object(f.jsx)(p.b,{className:"mx-auto  w-5 h-5 "})}),Object(f.jsx)("button",{className:" w-12 h-10 bg-gray-100 ml-1 p-1 rounded border-gray-300 text-gray-700  opacity-60  hover:opacity-100",onClick:function(){pe(-.6)},children:Object(f.jsx)(p.c,{className:"mx-auto w-5 h-5 "})})]})]}),xe&&Object(f.jsx)(x,{isShown:!0,progress:o})]})},_=n(96),M=n(183);var I=function(e){var t,n=e.id,a=e.category,o=e.enabled,i=e.value,r=e.setThis,c=e.removeItem,s=e.index,l=e.searchColors,d=e.numResultsHere,u=e.zoomToMe,b=l[s%l.length];return Object(f.jsxs)("div",{className:"border-gray-100 border-b mb-3 pb-3",children:[Object(f.jsx)("input",{name:"isGoing",type:"checkbox",style:{outline:o&&i.length>0?"1px solid rgb(".concat(b[0],",").concat(b[1],",").concat(b[2],")"):"0px",outlineOffset:"2px"},className:"w-3 h-3 m-3",checked:o,onChange:function(e){return r({enabled:!o})}}),Object(f.jsxs)("select",{className:" w-36 border py-2 px-1 text-grey-darkest text-sm h-10",value:a,onChange:function(e){return r({category:e.target.value})},children:[Object(f.jsx)("option",{value:"name",children:"Sequence name"}),Object(f.jsx)("option",{value:"lineage",children:"Lineage"}),Object(f.jsx)("option",{value:"country",children:"Country"}),Object(f.jsx)("option",{value:"mutation",children:"AA mutation"})]}),"\xa0",Object(f.jsx)(M.DebounceInput,{className:" w-32 border py-2 px-3 text-grey-darkest h-10",value:i,onChange:function(e){return r({value:e.target.value})},debounceTimeout:300}),Object(f.jsx)("button",{className:" bg-gray-100 text-sm mx-auto p-1 rounded border-gray-300 border  text-gray-700 ml-2 h-8",onClick:function(){return c(n)},children:Object(f.jsx)(_.c,{className:"inline-block "})}),Object(f.jsx)("div",{className:"text-sm text-gray-600 px-3",children:{name:"Enter a sequence name like QEUH-13ADA01",lineage:"Enter a PANGO lineage like B.1.1.7. Note that sub-lineages will not be found by this method.",country:"Enter a country like 'India' ",mutation:"Enter an amino acid mutation like S:E484K"}[a]}),Object(f.jsxs)("div",{className:"text-sm text-gray-900 px-3",children:[" ",i.length>0&&Object(f.jsxs)(f.Fragment,{children:[" ",(t=d,new Intl.NumberFormat("en-US").format(t))," result",1!==d&&Object(f.jsx)(f.Fragment,{children:"s"})]}),1===d&&o&&Object(f.jsxs)(f.Fragment,{children:[" ",Object(f.jsxs)("button",{onClick:u,className:"inline-block bg-gray-100 text-sm mx-auto p-1 rounded border-gray-300 border m-1 text-gray-700",children:[Object(f.jsx)(p.b,{className:"inline-block mr-1"}),"locate"]})]})]})]})},z=n(184),A=n(185);var T=function(e){var t,n=e.searchItems,a=e.setSearchItems,o=e.colourBy,i=e.setColourBy,r=e.selectedNode,s=e.data,l=e.searchColors,u=e.numSearchResults,b=e.totalSeqs,m=e.setZoomToSearch,j=s.node_data;return Object(f.jsxs)("div",{children:[Object(f.jsxs)("div",{className:" border-t md:border-t-0 border-b border-gray-300",children:[Object(f.jsxs)("div",{className:"mt-3 mb-3 text-gray-500 text-sm",children:["Displaying ",(t=b,new Intl.NumberFormat("en-US").format(t))," sequences from GISAID"]}),Object(f.jsxs)("h2",{className:"text-xl mt-5 mb-4 text-gray-700",children:[Object(f.jsx)(z.a,{className:"inline-block mr-2"}),"Search"]}),n.map((function(e,t){return Object(f.jsx)(I,{numResultsHere:u[t],searchColors:l,index:t,id:e.id,category:e.category,value:e.value,setThis:function(e){n[t]=Object(d.a)(Object(d.a)({},n[t]),e),a(Object(c.a)(n))},zoomToMe:function(){console.log(t),m({index:t})},removeItem:function(e){a(n.filter((function(t){return t.id!==e})))},enabled:e.enabled},e.id)})),Object(f.jsxs)("button",{className:"block bg-gray-100 text-sm mx-auto p-1 rounded border-gray-300 border m-5 text-gray-700",onClick:function(){return a([].concat(Object(c.a)(n),[{id:Math.random(),category:"name",value:"",enabled:!0}]))},children:[Object(f.jsx)(A.a,{className:"inline-block mr-2"}),"Add a new search"]})]}),Object(f.jsxs)("div",{className:"border-b border-gray-300 pb-3",children:[Object(f.jsxs)("h2",{className:"text-xl mt-5 mb-4 text-gray-700",children:[Object(f.jsx)(p.a,{className:"inline-block mr-2"}),"Colour by"]}),Object(f.jsxs)("select",{className:"border py-2 px-3 text-grey-darkest",value:o,onChange:function(e){return i(e.target.value)},children:[Object(f.jsx)("option",{value:"lineage",children:"Lineage"}),Object(f.jsx)("option",{value:"country",children:"Country"}),Object(f.jsx)("option",{value:"none",children:"None"})]})]}),Object(f.jsx)("div",{children:r&&Object(f.jsxs)("div",{className:"text-gray-500 mr-3",children:[Object(f.jsxs)("h2",{className:"text-xl mt-5 mb-4 text-gray-700",children:[Object(f.jsx)(_.a,{className:"inline-block mr-2"}),"Node info"]}),Object(f.jsx)("div",{className:"font-bold",children:j.genbanks[r]}),j.genbanks[r]&&"unknown"!==j.genbanks[r]&&"nan"!==j.genbanks[r]&&Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"font-semibold"})," ",j.names[r]]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"font-semibold",children:"Date:"})," ",s.date_mapping[j.dates[r]]]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"font-semibold",children:"Lineage:"})," ",Object(f.jsx)("a",{className:"underline",target:"_blank",rel:"noreferrer",href:"https://outbreak.info/situation-reports?pango="+s.lineage_mapping[j.lineages[r]],children:s.lineage_mapping[j.lineages[r]]})]}),Object(f.jsxs)("div",{children:[Object(f.jsx)("span",{className:"font-semibold",children:"Country:"})," ",s.country_mapping[j.countries[r]]]}),Object(f.jsx)("span",{className:"font-semibold",children:"Mutations:"}),Object(f.jsx)("div",{className:"text-xs mr-5",children:j.mutations[r].mutation&&j.mutations[r].mutation.map((function(e){return s.mutation_mapping[e]})).join(", ")})]})})]})},P=n(186),D=n.n(P);var L=function(e){var t=e.enabled,n=e.setEnabled;return Object(f.jsxs)("div",{className:"w-full ".concat(t?"":"hidden"),children:[Object(f.jsx)("div",{onClick:function(){return n(!1)},className:"fixed w-full h-full bg-black opacity-80 z-40"}),Object(f.jsxs)("div",{onClick:function(){return n(!1)},className:"fixed w-full h-full  opacity-100 z-40",children:[Object(f.jsxs)("div",{className:" relative mx-auto mt-5 p-5 bg-white shadow-md z-100 w-4/5 overflow-y-auto opacity-100 ",style:{height:"90vh"},children:[Object(f.jsx)("button",{className:"absolute top-5 right-5 text-xl font-bold",onClick:function(){return n(!1)},children:"X"}),Object(f.jsx)("h1",{className:"font-bold mb-3 text-xl",children:"About Cov2Tree"}),"This tool allows you to explore a phylogenetic tree with hundreds of thousands of SARS-CoV-2 sequences, sequenced by researchers around the world and shared via the GISAID Initiative. The interface was made by"," ",Object(f.jsx)("a",{className:"text-blue-700 underline",href:"http://theo.io/",children:"Theo Sanderson"})," ","using a custom-developed open-source library called"," ",Object(f.jsxs)("a",{href:"http://github.com/theosanderson/taxodium",className:"text-blue-700 underline",children:[" ","Taxodium"]}),".",Object(f.jsx)("h1",{className:"font-bold mb-3 text-xl mt-6",children:"The sequences"}),Object(f.jsx)("p",{children:"We gratefully acknowledge all data contributors, i.e. the Authors and their Originating laboratories responsible for obtaining the specimens, and their Submitting laboratories for generating the genetic sequence and metadata and sharing via the GISAID Initiative on which this research is based."}),Object(f.jsx)("h1",{className:"font-bold mb-3 text-xl mt-6",children:"The tree"}),Object(f.jsxs)("p",{children:["The tree shown here is the GISAID Audacity Tree. This tree uses a variation of the sarscov2phylo method developed by Robert Lanfear. The genome sequences were first aligned to the GISAID reference sequence WIV04 (Zheng-li Shi et al 2020). Lineages are assigned using"," ",Object(f.jsx)("a",{className:"text-blue-700 underline",href:"https://www.pango.network/",children:"Pangolin"}),"."]}),Object(f.jsx)("h1",{className:"font-bold mb-3 text-xl mt-4",children:"Citations"}),Object(f.jsxs)("div",{className:"text-sm",children:[Object(f.jsx)("p",{children:"Lanfear, Rob (2020). A global phylogeny of SARS-CoV-2 sequences from GISAID. Zenodo DOI: 10.5281/zenodo.3958883"}),Object(f.jsx)("p",{children:"Rambaut et al. (2020). A dynamic nomenclature proposal for SARS-CoV-2 lineages to assist genomic epidemiology."}),Object(f.jsx)("p",{children:"Elbe, S., and Buckland-Merrett, G. (2017) Data, disease and diplomacy: GISAID\u2019s innovative contribution to global health. Global Challenges, 1:33-46. DOI: 10.1002/gch2.1018 PMCID: 31565258"})]})]})," "]})]})},R=n(191),E=n(188),F=n(233);F.parse.defaults.keepCase=!0;var W=[[255,0,0],[183,0,255],[255,213,0],[0,0,255],[0,255,255]];var q=function(){var e=Object(a.useState)({index:null}),t=Object(s.a)(e,2),n=t[0],o=t[1],i=Object(a.useState)([{id:.123,category:"lineage",value:"",enabled:!0}]),r=Object(s.a)(i,2),l=r[0],d=r[1],u=Object(a.useCallback)((function(e){d(e)}),[]),b=Object(a.useState)("lineage"),m=Object(s.a)(b,2),j=m[0],h=m[1],g=Object(a.useCallback)((function(e){h(e)}),[]),x=Object(a.useState)({status:"not_attempted",data:{node_data:{ids:[]}}}),p=Object(s.a)(x,2),O=p[0],v=p[1],y=Object(a.useState)(null),w=Object(s.a)(y,2),N=w[0],k=w[1],S=Object(a.useState)(!1),M=Object(s.a)(S,2),I=M[0],z=M[1];Object(a.useEffect)((function(){"not_attempted"===O.status&&(console.log("starting dl"),v({status:"loading",progress:0,data:{node_data:{ids:[]}}}),F.load("./tree.proto").then((function(e){D.a.get("/nodelist.pb",{responseType:"arraybuffer",onDownloadProgress:function(e){var t=Math.floor(e.loaded/1e8*1*100);v({status:"loading",progress:t,data:{node_data:{ids:[]}}})}}).then((function(e){return e.data})).then((function(t){console.log("buffer loaded");var n=e.lookupType("AllData"),a=n.decode(new Uint8Array(t)),o=n.toObject(a);o.node_data.ids=Object(c.a)(Array(o.node_data.x.length).keys()),o.node_data.x=o.node_data.x.map((function(e){return 4e4*e})),o.node_data.y=o.node_data.y.map((function(e){return.16*e})),window.nd=o.node_data,o.mutation_mapping=o.mutation_mapping.map((function(e){return e.replace("Spike","S")})),v({status:"loaded",data:o})}))})))}),[O.status]);var A=Object(a.useMemo)((function(){return"loaded"===O.status?O.data:{node_data:{ids:[]}}}),[O]),P=Object(a.useMemo)((function(){return A.node_data.ids.filter((function(e){return""!==A.node_data.names[e]}))}),[A]),q=Object(a.useMemo)((function(){var e=l.map((function(e,t){var n,a=e.value.toLowerCase().trim();if("mutation"===e.category){var o=A.mutation_mapping.indexOf(e.value);n=function(e){return A.node_data.mutations[e].mutation&&A.node_data.mutations[e].mutation.includes(o)}}"name"===e.category&&(n=function(e){return A.node_data.names[e].toLowerCase().includes(a)}),"country"===e.category&&(n=function(e){return A.country_mapping[A.node_data.countries[e]].toLowerCase()===a}),"lineage"===e.category&&(n=function(e){return A.lineage_mapping[A.node_data.lineages[e]].toLowerCase()===a});var i=null!==e.value&&""!==e.value&&e.enabled;return{original_index:t,id:"main-search-"+t,enabled:i,data:""!==e.value?P.filter(n):[],opacity:.7,getRadius:7+2*t,filled:!1,stroked:!0,radiusUnits:"pixels",lineWidthUnits:"pixels",lineWidthScale:1,getPosition:function(e){return[A.node_data.x[e],A.node_data.y[e]]},getFillColor:function(e){return[0,0,0]},getLineColor:function(e){return W[t%W.length]}}})),t=e.map((function(e){return e.data.length}));return[e.filter((function(e){return e.enabled})),t,P.length]}),[A,l,P]),G=Object(s.a)(q,3),B=G[0],U=G[1],V=G[2];return Object(f.jsxs)(R.a,{children:[Object(f.jsx)(L,{enabled:I,setEnabled:z}),Object(f.jsxs)("div",{className:"h-screen w-screen",children:[Object(f.jsx)("div",{className:"from-gray-500 to-gray-600 bg-gradient-to-bl h-15 shadow-md z-20",children:Object(f.jsxs)("div",{className:"flex justify-between",children:[Object(f.jsxs)("h1",{className:"text-xl p-4  pb-5 text-white ",children:[Object(f.jsx)(E.a,{className:"inline-block h-8 w-8 pr-2 "}),Object(f.jsx)("span",{className:"font-bold",children:"Cov2Tree"}),":"," ",Object(f.jsxs)("span",{className:"font-light",children:["interactive SARS-CoV-2 phylogeny"," "]})]}),Object(f.jsx)("div",{className:"inline-block p-4",children:Object(f.jsxs)("button",{onClick:function(){return z(!0)},className:"mr-10 text-white font-bold hover:underline",children:[Object(f.jsx)(_.b,{className:"inline-block h-7 w-8"})," About / Acknowledgements"]})})]})}),Object(f.jsx)("div",{className:"main_content",children:Object(f.jsxs)("div",{className:"md:grid md:grid-cols-12 h-full",children:[Object(f.jsx)("div",{className:"md:col-span-8 h-3/6 md:h-full w-full",children:Object(f.jsx)(C,{search_configs_initial:B,scatterIds:P,searchColors:W,setSelectedNode:k,searchItems:l,data:A,progress:O.progress,colourBy:j,zoomToSearch:n})}),Object(f.jsx)("div",{className:"md:col-span-4 h-full bg-white  border-gray-600   pl-5 shadow-xl",children:Object(f.jsx)(T,{setZoomToSearch:o,totalSeqs:V,numSearchResults:U,searchColors:W,selectedNode:N,searchItems:l,data:A,setSearchItems:u,colourBy:j,setColourBy:g})})]})})]})]})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,276)).then((function(t){var n=t.getCLS,a=t.getFID,o=t.getFCP,i=t.getLCP,r=t.getTTFB;n(e),a(e),o(e),i(e),r(e)}))};r.a.render(Object(f.jsx)(o.a.StrictMode,{children:Object(f.jsx)(q,{})}),document.getElementById("root")),G()}},[[253,1,2]]]);
//# sourceMappingURL=main.72ff8519.chunk.js.map